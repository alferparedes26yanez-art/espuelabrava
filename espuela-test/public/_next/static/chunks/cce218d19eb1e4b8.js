(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59145,(e,s,a)=>{s.exports=e.r(2905)},93172,e=>{"use strict";let s={usuarios:[{user:"admin",pass:"8888",nombre:"DueÃ±o",saldo:0,rol:"admin"},{user:"cliente1",pass:"1234",nombre:"Juan PÃ©rez",saldo:500,rol:"cliente"},{user:"cliente2",pass:"1234",nombre:"MarÃ­a GarcÃ­a",saldo:300,rol:"cliente"}],cuota:1.8,apuestasAbiertas:!1,tiempoRestante:0,apuestasActuales:[],numeroPelea:1},a=[],t=()=>{a.forEach(e=>e())};window.mockDB=s,e.s(["authService",0,{login:async(e,a)=>(await new Promise(e=>setTimeout(e,300)),s.usuarios.find(s=>s.user===e&&s.pass===a)||null),getCurrentUser:()=>{let e=sessionStorage.getItem("currentUser");return e?JSON.parse(e):null},setCurrentUser:e=>{e?sessionStorage.setItem("currentUser",JSON.stringify(e)):sessionStorage.removeItem("currentUser")},logout:()=>{sessionStorage.removeItem("currentUser")}},"betService",0,{realizarApuesta:async(e,a,r)=>{if(await new Promise(e=>setTimeout(e,150)),!s.apuestasAbiertas||s.tiempoRestante<=0)throw Error("Las apuestas estÃ¡n cerradas");let i=s.usuarios.find(s=>s.user===e);if(!i)throw Error("Usuario no encontrado");if(r>i.saldo||r<=0)throw Error("Saldo insuficiente");return i.saldo-=r,s.apuestasActuales.push({user:e,opcion:a,monto:r,timestamp:Date.now()}),t(),!0},pagarGanadores:async e=>{await new Promise(e=>setTimeout(e,200));let a=0;return s.apuestasActuales.forEach(t=>{if(t.opcion===e){let e=s.usuarios.find(e=>e.user===t.user);if(e){let r=t.monto*s.cuota;e.saldo+=r,a+=r}}}),s.apuestasActuales=[],s.apuestasAbiertas=!1,s.tiempoRestante=0,t(),a},getApuestasActuales:async()=>(await new Promise(e=>setTimeout(e,50)),[...s.apuestasActuales])},"fightService",0,{getEstadoPelea:async()=>(await new Promise(e=>setTimeout(e,50)),{numeroPelea:s.numeroPelea,cuota:s.cuota,apuestasAbiertas:s.apuestasAbiertas,tiempoRestante:s.tiempoRestante,apuestasActuales:s.apuestasActuales}),updateNumeroPelea:async e=>(await new Promise(e=>setTimeout(e,100)),s.numeroPelea=e,t(),!0),updateCuota:async e=>(await new Promise(e=>setTimeout(e,100)),s.cuota=e,t(),!0),controlarApuestas:async(e,a)=>(await new Promise(e=>setTimeout(e,100)),s.apuestasAbiertas=e,e&&a?(s.tiempoRestante=a,s.apuestasActuales=[]):s.tiempoRestante=0,t(),!0),decrementarTiempo:()=>{s.tiempoRestante>0&&(s.tiempoRestante--,0===s.tiempoRestante&&(s.apuestasAbiertas=!1),t())}},"subscribeToChanges",0,e=>(a.push(e),()=>{a=a.filter(s=>s!==e)}),"userService",0,{createUser:async(e,a,r)=>{if(await new Promise(e=>setTimeout(e,200)),s.usuarios.find(e=>e.user===a))throw Error("El usuario ya existe");return s.usuarios.push({user:a,pass:r,nombre:e,saldo:0,rol:"cliente"}),t(),!0},getClientes:async()=>(await new Promise(e=>setTimeout(e,100)),s.usuarios.filter(e=>"cliente"===e.rol)),updateSaldo:async(e,a,r)=>{await new Promise(e=>setTimeout(e,150));let i=s.usuarios.find(s=>s.user===e);return!!i&&("sumar"===r?i.saldo+=a:i.saldo-=a,t(),!0)},getUserByUsername:async e=>(await new Promise(e=>setTimeout(e,50)),s.usuarios.find(s=>s.user===e)||null)}])},64275,e=>{"use strict";var s=e.i(72724),a=e.i(65450),t=e.i(59145),r=e.i(93172);function i(){let e=(0,t.useRouter)(),[i,n]=(0,a.useState)(null),[o,l]=(0,a.useState)(null),[u,c]=(0,a.useState)(10),[d,m]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let s=r.authService.getCurrentUser();if(!s)return void e.push("/login");if("cliente"!==s.rol)return void e.push("/dashboard/admin");n(s),p(),m(!1);let a=(0,r.subscribeToChanges)(()=>{p(),h(s.user)}),t=setInterval(()=>{r.fightService.decrementarTiempo()},1e3);return()=>{a(),clearInterval(t)}},[e]);let p=async()=>{l(await r.fightService.getEstadoPelea())},h=async e=>{let s=await r.authService.login(e,i?.pass||"");s&&(n(s),r.authService.setCurrentUser(s))},x=async e=>{if(i&&o)try{await r.betService.realizarApuesta(i.user,e,u),alert(`\xa1Apuesta al ${e} recibida!`),await h(i.user),await p()}catch(e){alert(e.message||"Error al realizar apuesta")}};if(d||!i||!o)return(0,s.jsx)("div",{className:"loading",children:"Cargando..."});let A=!o.apuestasAbiertas||o.tiempoRestante<=0;return(0,s.jsxs)("div",{id:"main-dashboard",children:[(0,s.jsxs)("nav",{className:"navbar",children:[(0,s.jsx)("div",{className:"logo",children:"ðŸ¥Š Espuela Brava"}),(0,s.jsxs)("div",{className:"user-info",children:[(0,s.jsxs)("div",{className:"saldo-box",children:[(0,s.jsx)("span",{children:"SALDO DISPONIBLE"}),(0,s.jsxs)("strong",{children:["$",i.saldo.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"profile",children:[(0,s.jsx)("span",{children:i.nombre}),(0,s.jsx)("div",{className:"avatar",children:"ðŸ“"})]}),(0,s.jsx)("button",{onClick:()=>{r.authService.logout(),e.push("/login")},className:"btn-logout",children:"Salir"})]})]}),(0,s.jsxs)("div",{className:"game-container",children:[(0,s.jsxs)("div",{className:"timer-container",children:[(0,s.jsxs)("div",{className:"timer-circle",children:[(0,s.jsx)("span",{id:"reloj-display",children:o.tiempoRestante<10?`0${o.tiempoRestante}`:o.tiempoRestante}),(0,s.jsx)("small",{children:"SEGUNDOS"})]}),(0,s.jsx)("div",{className:o.apuestasAbiertas&&o.tiempoRestante>0?"status-open":"status-closed",children:o.apuestasAbiertas&&o.tiempoRestante>0?"â— APUESTAS ABIERTAS":"â— CERRADO"})]}),(0,s.jsxs)("h2",{className:"pelea-titulo",children:["Pelea No. ",(0,s.jsx)("span",{children:o.numeroPelea})]}),(0,s.jsx)("p",{className:"subtitulo",children:"Arena Principal â€¢ Derby Invernal"}),(0,s.jsxs)("div",{className:"apuesta-selector",children:[(0,s.jsx)("span",{children:"CUÃNTO QUIERES APOSTAR:"}),(0,s.jsx)("div",{className:"monto-control",children:(0,s.jsx)("input",{type:"number",value:u,onChange:e=>c(Number(e.target.value)),min:"1",max:i.saldo})})]}),(0,s.jsxs)("div",{className:"bet-grid",children:[(0,s.jsxs)("button",{className:"card rojo",onClick:()=>x("Rojo"),children:[(0,s.jsx)("div",{className:"icon",children:"ðŸ“"}),(0,s.jsx)("h3",{children:"GALLO ROJO"}),(0,s.jsxs)("span",{className:"cuota-badge",children:["CUOTA: ",(0,s.jsxs)("b",{children:[o.cuota,"x"]})]})]}),(0,s.jsxs)("button",{className:"card empate",onClick:()=>x("Empate"),children:[(0,s.jsx)("div",{className:"icon",children:"âš–ï¸"}),(0,s.jsx)("h3",{children:"EMPATE"}),(0,s.jsx)("span",{className:"cuota-badge",children:"TABLAS"})]}),(0,s.jsxs)("button",{className:"card azul",onClick:()=>x("Azul"),children:[(0,s.jsx)("div",{className:"icon",children:"ðŸ“"}),(0,s.jsx)("h3",{children:"GALLO AZUL"}),(0,s.jsxs)("span",{className:"cuota-badge",children:["CUOTA: ",(0,s.jsxs)("b",{children:[o.cuota,"x"]})]})]})]}),(0,s.jsx)("p",{className:"footer-msg",children:"Las apuestas se bloquean al llegar a cero."})]}),A&&(0,s.jsx)("div",{className:"closed-overlay",children:(0,s.jsxs)("div",{className:"closed-message",children:[(0,s.jsx)("div",{style:{fontSize:"50px"},children:"ðŸ”’"}),(0,s.jsx)("h1",{children:"APUESTAS CERRADAS"}),(0,s.jsx)("p",{children:"ESPERA A LA SIGUIENTE PELEA"})]})})]})}e.s(["default",()=>i])}]);